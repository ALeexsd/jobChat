# ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. ‚úÖ –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞

**–†–µ—à–µ–Ω–∏–µ:**

**Frontend (ChatDetailView.vue):**
```javascript
async function clearChatHistory() {
  if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
    return
  }
  
  try {
    await api.delete(`/chats/${route.params.id}/messages`)
    messages.value = []
    alert('–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –æ—á–∏—â–µ–Ω–∞')
  } catch (error) {
    console.error('Clear chat error:', error)
    alert('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ —á–∞—Ç–∞')
  }
}
```

**Backend (chats.py):**
```python
@router.delete("/{chat_id}/messages")
async def clear_chat_messages(
    chat_id: int,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db)
):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —á–∞—Ç–∞
    member_result = await db.execute(
        select(ChatMember)
        .where(
            ChatMember.chat_id == chat_id,
            ChatMember.user_id == current_user.id
        )
    )
    member = member_result.scalar_one_or_none()
    
    if not member:
        raise HTTPException(status_code=403, detail="Access denied")
    
    # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞
    from sqlalchemy import delete
    await db.execute(
        delete(Message).where(Message.chat_id == chat_id)
    )
    await db.commit()
    
    return {"message": "Chat history cleared"}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI

---

### 2. ‚úÖ –≠–º–æ–¥–∑–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ —ç–º–æ–¥–∑–∏ –≤ –æ–¥–Ω–æ–º —Å–ø–∏—Å–∫–µ, –Ω–µ—É–¥–æ–±–Ω–æ –∏—Å–∫–∞—Ç—å

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
const emojiCategories = {
  '–°–º–∞–π–ª–∏–∫–∏': ['üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'ü§£', 'üòÇ', 'üôÇ', 'üôÉ', 'üòâ', 'üòä', 'üòá', 'ü•∞', 'üòç', 'ü§©', 'üòò', 'üòó', 'üòö', 'üòô'],
  '–ñ–µ—Å—Ç—ã': ['üëç', 'üëé', 'üëå', '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ò', 'ü§ô', 'üëà', 'üëâ', 'üëÜ', 'üëá', '‚òùÔ∏è', '‚úã', 'ü§ö', 'üñêÔ∏è', 'üññ', 'üëã', 'ü§ù', 'üôè'],
  '–≠–º–æ—Ü–∏–∏': ['‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíî', '‚ù£Ô∏è', 'üíï', 'üíû', 'üíì', 'üíó', 'üíñ', 'üíò', 'üíù', 'üíü'],
  '–°–∏–º–≤–æ–ª—ã': ['üî•', 'üíØ', '‚ú®', '‚≠ê', 'üåü', 'üí´', '‚ö°', 'üí•', 'üéâ', 'üéä', 'üéà', 'üéÅ', 'üèÜ', 'ü•á', 'ü•à', 'ü•â', 'üéØ', 'üé™', 'üé≠', 'üé®'],
  '–ü—Ä–∏—Ä–æ–¥–∞': ['üå∏', 'üå∫', 'üåª', 'üå∑', 'üåπ', 'ü•Ä', 'üåº', 'üå±', 'üåø', 'üçÄ', 'üçÉ', 'üçÇ', 'üçÅ', 'üåæ', 'üåµ', 'üå¥', 'üå≥', 'üå≤', 'üå∞', 'üåä'],
  '–ï–¥–∞': ['üçï', 'üçî', 'üçü', 'üå≠', 'üçø', 'üßÇ', 'ü•ì', 'ü•ö', 'üç≥', 'üßá', 'ü•û', 'üßà', 'üçû', 'ü•ê', 'ü•®', 'ü•Ø', 'ü•ñ', 'üßÄ', 'ü•ó', 'üçñ']
}

const selectedEmojiCategory = ref('–°–º–∞–π–ª–∏–∫–∏')
const emojis = computed(() => emojiCategories[selectedEmojiCategory.value] || [])
```

**UI:**
```vue
<div v-if="showEmojiPicker" class="absolute bottom-20 right-6 card p-4 w-96 max-h-96 overflow-y-auto">
  <h3 class="text-sm font-semibold mb-3">–≠–º–æ–¥–∑–∏</h3>
  
  <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
  <div class="flex gap-2 mb-3 overflow-x-auto pb-2">
    <button
      v-for="(emojis, category) in emojiCategories"
      :key="category"
      @click="selectedEmojiCategory = category"
      :class="[
        'px-3 py-1 text-xs font-medium rounded-full whitespace-nowrap transition-colors',
        selectedEmojiCategory === category
          ? 'bg-primary-600 text-white'
          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
      ]"
    >
      {{ category }}
    </button>
  </div>
  
  <!-- –≠–º–æ–¥–∑–∏ -->
  <div class="grid grid-cols-8 gap-2">
    <button
      v-for="emoji in emojis"
      :key="emoji"
      @click="addEmoji(emoji)"
      class="text-2xl hover:bg-gray-100 rounded p-1 transition-colors"
    >
      {{ emoji }}
    </button>
  </div>
</div>
```

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:**
- üòÄ **–°–º–∞–π–ª–∏–∫–∏** - 20 —ç–º–æ–¥–∑–∏
- üëç **–ñ–µ—Å—Ç—ã** - 20 —ç–º–æ–¥–∑–∏
- ‚ù§Ô∏è **–≠–º–æ—Ü–∏–∏** - 19 —ç–º–æ–¥–∑–∏
- üî• **–°–∏–º–≤–æ–ª—ã** - 20 —ç–º–æ–¥–∑–∏
- üå∏ **–ü—Ä–∏—Ä–æ–¥–∞** - 20 —ç–º–æ–¥–∑–∏
- üçï **–ï–¥–∞** - 20 —ç–º–æ–¥–∑–∏

**–í—Å–µ–≥–æ: 119 —ç–º–æ–¥–∑–∏!**

---

### 3. üìù –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤

**–°—Ç–∞—Ç—É—Å:** –ö–æ–¥ —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

**ChatDetailView.vue:**
```vue
<!-- Attachments -->
<div v-if="message.attachments?.length" class="mt-2 space-y-2">
  <div v-for="attachment in message.attachments" :key="attachment.id">
    <img
      v-if="attachment.file_type.startsWith('image/')"
      :src="`http://localhost:8000${attachment.file_path}`"
      :alt="attachment.file_name"
      class="max-w-xs rounded-lg"
    />
    
    <audio
      v-else-if="attachment.file_type.startsWith('audio/')"
      :src="`http://localhost:8000${attachment.file_path}`"
      controls
      class="w-full max-w-xs"
    />
    
    <a
      v-else
      :href="`http://localhost:8000${attachment.file_path}`"
      target="_blank"
      class="flex items-center p-2 rounded-lg"
    >
      <DocumentIcon class="w-5 h-5 mr-2" />
      {{ attachment.file_name }}
    </a>
  </div>
</div>
```

**Backend (chats.py):**
```python
# –ü–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
result = await db.execute(
    select(Message)
    .options(selectinload(Message.attachments))
    .where(Message.chat_id == chat_id)
    .order_by(Message.created_at)
)
messages = result.scalars().all()
return messages
```

**–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ `/media/`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `attachments` –≤ –æ—Ç–≤–µ—Ç–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

### 4. üîç –ü–æ–∏—Å–∫ (—Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å)

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `GET /users?search=...`
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ @username –≤ –ø—Ä–æ—Ñ–∏–ª—è—Ö
- ‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ username, first_name, last_name

**–ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- üîÑ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –≤ MainView
- üîÑ –ü–æ–∏—Å–∫ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º
- üîÑ –ü–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–∞–º
- üîÑ –ü–æ–∏—Å–∫ –ø–æ –∑–∞–º–µ—Ç–∫–∞–º

**–î–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω–æ:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –≤ MainView
2. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç SearchModal
3. –î–æ–±–∞–≤–∏—Ç—å endpoints –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–∑–Ω—ã–º —Å—É—â–Ω–æ—Å—Ç—è–º
4. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞

---

## üöÄ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

```
‚úÖ Backend   - –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
‚úÖ Frontend  - –ü–µ—Ä–µ—Å–æ–±—Ä–∞–Ω –∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
‚úÖ Postgres  - –†–∞–±–æ—Ç–∞–µ—Ç
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –º–µ–Ω—é (—Ç—Ä–∏ —Ç–æ—á–∫–∏)
3. –í—ã–±–µ—Ä–∏—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é"
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã

### 2. –≠–º–æ–¥–∑–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —ç–º–æ–¥–∑–∏ (üòÄ)
3. –ü–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –≠–º–æ–¥–∑–∏ –º–µ–Ω—è—é—Ç—Å—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### 3. –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏

---

## üìä –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ **–ß–∞—Ç—ã:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ (–Ω–æ–≤–æ–µ!)
- Drag & Drop —Ñ–∞–π–ª–æ–≤
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤

‚úÖ **–≠–º–æ–¥–∑–∏:**
- 6 –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–Ω–æ–≤–æ–µ!)
- 119 —ç–º–æ–¥–∑–∏ (–Ω–æ–≤–æ–µ!)
- –£–¥–æ–±–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (–Ω–æ–≤–æ–µ!)

‚úÖ **–ü—Ä–æ—Ñ–∏–ª—å:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
- –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

‚úÖ **–ü–æ–∏—Å–∫:**
- –ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ü–æ @username
- –ü–æ –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫:

1. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –≤ —à–∞–ø–∫—É
   - –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Å—É—â–Ω–æ—Å—Ç—è–º
   - –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

2. **–ü–æ–∏—Å–∫ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º:**
   - Endpoint –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ —á–∞—Ç–∞—Ö
   - –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   - –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é

3. **–§–∏–ª—å—Ç—Ä—ã:**
   - –ü–æ —Ç–∏–ø—É (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —á–∞—Ç—ã, –∑–∞–¥–∞—á–∏)
   - –ü–æ –¥–∞—Ç–µ
   - –ü–æ —Å—Ç–∞—Ç—É—Å—É

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —á–∞—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –≠–º–æ–¥–∑–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- ‚úÖ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–µ–π—á–∞—Å! üéâ

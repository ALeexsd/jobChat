# ‚úÖ –ù–æ–≤—ã–µ —Ñ–∏—á–∏ —á–∞—Ç–∞ - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

## üé§ 1. –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (MediaRecorder API)
- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —á–∞—Ç–∞ (–º–∏–∫—Ä–æ—Ñ–æ–Ω)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ WebM

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
2. –ì–æ–≤–æ—Ä–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –û—Ç–ø—É—Å—Ç–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è: `AUDIO`
- –§–æ—Ä–º–∞—Ç: `audio/webm`
- API endpoint: `POST /api/messages/upload`

## üîç 2. –ü–æ–∏—Å–∫ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–µ–∫—É—â–µ–º —á–∞—Ç–µ
- –ñ–∏–≤–æ–π –ø–æ–∏—Å–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 300–º—Å
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞ (üîç) –≤ header —á–∞—Ç–∞
2. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
3. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- API endpoint: `GET /api/messages/search?query=...&chat_id=...`
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º
- –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é

## üìå 3. –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
- –ü–∞–Ω–µ–ª—å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤–≤–µ—Ä—Ö—É —á–∞—Ç–∞
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (üìå)
- –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ —Å–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è (üìå) –≤ –º–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π
3. –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ –≤–≤–µ—Ä—Ö—É
4. –î–ª—è –æ—Ç–∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –µ—â–µ —Ä–∞–∑

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- API endpoints:
  - `POST /api/messages/{message_id}/pin` - –∑–∞–∫—Ä–µ–ø–∏—Ç—å
  - `DELETE /api/messages/{message_id}/pin` - –æ—Ç–∫—Ä–µ–ø–∏—Ç—å
  - `GET /api/messages/chat/{chat_id}/pinned` - –ø–æ–ª—É—á–∏—Ç—å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ
- –ü–æ–ª–µ –≤ –ë–î: `is_pinned` (Boolean)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ë—ç–∫–µ–Ω–¥:
1. **–ú–æ–¥–µ–ª—å Message** (`backend/app/models/message.py`):
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_pinned: Boolean`

2. **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î** (`backend/alembic/versions/add_is_pinned_to_messages.py`):
   - –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–æ–ª–±–µ—Ü `is_pinned` –≤ —Ç–∞–±–ª–∏—Ü—É `messages`

3. **API Messages** (`backend/app/api/messages.py`):
   - `POST /messages/{message_id}/pin` - –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
   - `DELETE /messages/{message_id}/pin` - –æ—Ç–∫—Ä–µ–ø–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
   - `GET /messages/chat/{chat_id}/pinned` - –ø–æ–ª—É—á–∏—Ç—å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ
   - `GET /messages/search` - –ø–æ–∏—Å–∫ (—É–∂–µ –±—ã–ª)

4. **–°—Ö–µ–º–∞ MessageResponse** (`backend/app/schemas/message.py`):
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_pinned: bool = False`

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
1. **ChatDetailView.vue**:
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ header
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–Ω–µ–ª—å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –≤ –º–µ–Ω—é —Å–æ–æ–±—â–µ–Ω–∏—è
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –§—É–Ω–∫—Ü–∏–∏: `handleSearch()`, `scrollToMessage()`, `loadPinnedMessages()`, `togglePinMessage()`
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `showSearch`, `searchQuery`, `searchResults`, `pinnedMessages`

2. **–ò–∫–æ–Ω–∫–∏** (Heroicons):
   - `MagnifyingGlassIcon` - –ø–æ–∏—Å–∫
   - `PushPinIcon` - –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ
   - `ChevronDownIcon` - –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é

3. **–ü–∞–∫–µ—Ç—ã**:
   - `vue-audio-recorder` - –¥–ª—è –∑–∞–ø–∏—Å–∏ –≥–æ–ª–æ—Å–∞ (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
   - `emoji-picker-element` - –Ω–æ–≤—ã–π emoji picker (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

## üé® UI/UX —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–æ–∏—Å–∫**:
   - –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞
   - –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º
   - –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞

2. **–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**:
   - –Ø—Ä–∫–∞—è –ø–∞–Ω–µ–ª—å —Å primary —Ü–≤–µ—Ç–æ–º
   - –ò–∫–æ–Ω–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–∏
   - –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞

3. **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**:
   - –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
   - –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏ (—É–∂–µ –±—ã–ª–∞)

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (—Å–ø—Ä–∞–≤–∞ –≤–Ω–∏–∑—É)
3. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –ì–æ–≤–æ—Ä–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
5. –û—Ç–ø—É—Å—Ç–∏—Ç–µ –∫–Ω–æ–ø–∫—É - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è

### –ü–æ–∏—Å–∫:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞ (üîç) –≤ header
3. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
4. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é

### –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
2. –ù–∞–≤–µ–¥–∏—Ç–µ –Ω–∞ —Å–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è (üìå) —Å–ª–µ–≤–∞ –æ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
4. –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ –≤–≤–µ—Ä—Ö—É
5. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–∞–Ω–µ–ª—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
6. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –µ—â–µ —Ä–∞–∑ –¥–ª—è –æ—Ç–∫—Ä–µ–ø–ª–µ–Ω–∏—è

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MediaRecorder API (Chrome, Firefox, Edge)
- –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏–π
- –ó–∞–∫—Ä–µ–ø–ª—è—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—Å–µ —Ñ–∏—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ WebSocket

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ WebM (–Ω–µ –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã –º–æ–≥—É—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å)
2. –ü–æ–∏—Å–∫ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
3. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π, –Ω–æ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ

## üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞—É–¥–∏–æ –≤–æ–ª–Ω—ã –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
2. –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ (–ø–æ –¥–∞—Ç–µ, –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é)
3. –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–∫—Ä–µ–ø–ª—è—Ç—å —á—É–∂–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
4. –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
5. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –∞—É–¥–∏–æ –≤ MP3 –¥–ª—è –ª—É—á—à–µ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
